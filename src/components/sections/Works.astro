---
import SectionHeader from "../common/SectionHeader.astro";
import FilterTabs from "../common/FilterTabs.astro";
import {experiences} from '../../data/experiences';

const sortedExperiences = experiences.sort((a, b) => b.startDate.localeCompare(a.startDate));

const filters = [
    {label: "All Roles", value: "all", icon: "*"},
    {label: "Internship", value: "internship", icon: "ðŸŽ“"},
    {label: "Casual", value: "casual", icon: "ðŸ§¢"},
]
---

<section id="work" class="work">
    <SectionHeader
        mainText="Work"
        highlightText="Experience"
        highlightClass="text-purple-400"
        underlineClass="bg-purple-400"
        subtitle="My journey into software development"
    />

    <FilterTabs 
        filters={filters}
        sectionColor="#a855f7"
        gradientStart="rgba(168, 85, 247, 0.15)"
        gradientEnd="rgba(192, 132, 252, 0.15)"
        boxShadow="rgba(168, 85, 247, 0.2)"
    />

    <div class="experiences">
        {sortedExperiences.map((exp, index) => (
            <div class="experience" data-category={exp.type}>
                <div class="timeline-marker">
                    <div class="timeline-dot"></div>
                    {index < sortedExperiences.length -1 && (
                        <div class="timeline-line"></div>
                    )}
                </div>

                <div class="content">
                    <div class="header">
                        <div class="header-top">
                            <h3 class="position-title">{exp.position}</h3>
                            <span class="period-badge">{exp.period}</span>
                        </div>
                        <div class="company-info">
                            <span class="company-name">
                                <i class="fa-solid fa-building text-purple-400"></i>
                                {exp.company}
                            </span>
                            <span class="location">
                                <i class="fa-solid fa-location-dot"></i>
                                {exp.location}
                            </span>
                        </div>
                    </div>

                    <div class="work-description">{exp.description}</div>

                    <!-- Achievements -->
                    <div class="mb-4">
                        <h4 class="achievements-title">Key Achievements:</h4>
                        <ul class="achievements-list">
                            {exp.achievements.map((achievement) => (
                                <li class="achievement-item">
                                    <span class="achievement-bullet">â–¸</span>
                                    {achievement}
                                </li>
                            ))}
                        </ul>
                    </div>

                    <div class="tech-list">
                        {exp.technologies.map((tech) => (
                            <span class="tech-item">{tech}</span>
                        ))}
                    </div>
                </div>
            </div>
        ))}
    </div>


</section>

<script>
    import { initializeFilter } from "../../utils/filter";
    initializeFilter("#work", ".experience")
</script>

<style>
    @reference "tailwindcss";

    .work {
        @apply max-w-7xl mx-auto px-6 my-20 md:my-40 scroll-mt-20 z-1
    }

    .experiences {
        @apply max-w-4xl mx-auto;
    }

    .experience {
        @apply grid grid-cols-[auto_1fr] gap-6 md:gap-8 mb-12 last:mb-0;
    }

    .experience.hidden {
        @apply opacity-0 scale-95 pointer-events-none;
        height: 0;
        margin: 0;
        overflow: hidden;
    }

    .timeline-marker {
        @apply flex flex-col items-center pt-2;
        width: 40px;
    }

    .timeline-dot {
        @apply rounded-full flex-shrink-0 transition-all duration-300;
        width: 20px;
        height: 20px;
        background: linear-gradient(135deg, #a855f7 0%, #c084fc 100%);
        box-shadow: 
            0 0 0 4px rgba(168, 85, 247, 0.2),
            0 0 20px rgba(168, 85, 247, 0.4);
        z-index: 2;
    }

    .experience:hover .timeline-dot {
        box-shadow: 
            0 0 0 6px rgba(168, 85, 247, 0.3),
            0 0 30px rgba(168, 85, 247, 0.6);
        transform: scale(1.2);
    }

    .timeline-line {
        @apply w-0.5 flex-1 mt-2;
        background: linear-gradient(
            180deg,
            rgba(168, 85, 247, 0.6) 0%,
            rgba(168, 85, 247, 0.3) 50%,
            rgba(168, 85, 247, 0.1) 100%
        );
        min-height: 60px;
    }

    .content {
        @apply rounded-xl p-6 transition-all duration-300;
        background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
        border: 1px solid #334155;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2);
    }

    .experience:hover .content {
        border-color: rgba(168, 85, 247, 0.5);
        box-shadow: 
            0 10px 30px -5px rgba(0, 0, 0, 0.3),
            0 0 20px rgba(168, 85, 247, 0.2);
        transform: translateX(8px);
    }

    .header {
        @apply mb-4 border-b border-slate-700;
    }

    .header-top {
        @apply flex flex-wrap items-start justify-between gap-3 mb-3;
    }

    .position-title {
        @apply text-xl md:text-2xl font-bold text-white;
    }

    .period-badge {
        @apply text-xs md:text-sm text-purple-300 px-3 py-1 rounded-full whitespace-nowrap;
        background: rgba(168, 85, 247, 0.1);
        border: 1px solid rgba(168, 85, 247, 0.3);
    }

    .company-info {
        @apply flex flex-wrap gap-4 text-sm text-slate-400;
    }

    .company-name, .location {
        @apply flex items-center gap-2;
    }

    .company-name {
        @apply text-purple-300 font-semibold;
    }

    .work-description {
        @apply text-slate-300 text-sm md:text-base leading-relaxed mb-4;
    }

    .achievements-title {
        @apply text-sm font-semibold text-purple-300 mb-2;
    }

    .achievements-list {
        @apply space-y-2 ml-2;
    }

    .achievement-item {
        @apply flex items-start gap-2 text-sm text-slate-300;
        list-style: none;
    }

    .achievement-bullet {
        @apply text-purple-400 font-bold flex-shrink-0;
    }

    .tech-list {
        @apply flex flex-wrap gap-2 pt-4 border-t border-slate-700;
    }

    .tech-item {
        @apply text-xs text-cyan-300 font-mono px-2 py-1 rounded;
        background: rgba(6, 182, 212, 0.1);
        border: 1px solid rgba(6, 182, 212, 0.2);
    }

    @media (max-width: 768px) {
        .timeline-marker {
            width: 30px;
        }

        .timeline-dot {
            width: 16px;
            height: 16px;
        }

        .experience:hover .content {
            transform: translateX(4px);
        }
    }

</style>
